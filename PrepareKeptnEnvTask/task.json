{
  "id": "872b7882-7628-4b7a-9d45-6fd14907c03f",
  "name": "PrepareKeptnEnvTask",
  "friendlyName": "Prepare Keptn environment",
  "description": "Initialize Keptn environment with project and stage",
  "author": "Dynatrace",
  "helpMarkDown": "Initialize Keptn environment with project and stage",
  "category": "Test",
  "visibility": [
    "Build",
    "Release"
  ],
  "demands": [],
  "version": {
    "Major": 2,
    "Minor": 0,
    "Patch": 0
  },
  "groups": [
    {
      "name": "keptn",
      "displayName": "Keptn Settings",
      "isExpanded": true
    },
    {
      "name": "config",
      "displayName": "Keptn Config",
      "isExpanded": false
    }
  ],
  "inputs": [
  	{
      "name": "keptnApiEndpoint",
      "type": "connectedService:Keptn",
      "label": "Keptn API Endpoint",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Connection to the Keptn API which is managed as a connectedService in AzureDevOps."
    },
    {
      "name": "project",
      "type": "string",
      "label": "Keptn Project",
      "defaultValue": "$(KeptnProject)",
      "required": true,
      "helpMarkDown": "The Keptn project",
      "groupName": "keptn"
    },
    {
      "name": "service",
      "type": "string",
      "label": "Keptn Service",
      "defaultValue": "$(KeptnService)",
      "required": true,
      "helpMarkDown": "The Keptn service",
      "groupName": "keptn"
    },
    {
      "name": "stage",
      "type": "string",
      "label": "Keptn Stage",
      "defaultValue": "$(KeptnStage)",
      "required": true,
      "helpMarkDown": "The Keptn stage",
      "groupName": "keptn"
    },
    {
      "name": "autoCreate",
      "type": "boolean",
      "label": "Create/Initialize project and service when they don't exist",
      "defaultValue": true,
      "required": true,
      "helpMarkDown": "Create/Initialize project and service when they don't exist",
      "groupName": "keptn"
    },
    {
      "name": "shipyardKind",
      "type": "pickList",
      "label": "Shipyard config",
      "options": {
        "generated": "Default generated",
        "inline": "Inline",
        "file": "File"
      },
      "required": true,
      "defaultValue": "generated",
      "helpMarkDown": "The type of shipyard config, either generated by the extension, provider inline or provided via a file.",
      "groupName": "config"
    },
    {
      "name": "shipyardInline",
      "type": "multiline",
      "label": "Shipyard content",
      "required": true,
      "defaultValue": "apiVersion: \"spec.keptn.sh/0.2.0\"\nkind: \"Shipyard\"\nmetadata:\n  name: \"shipyard-azdo\"\nspec:\n  stages:\n    - name: \"$(KeptnStage)\"",
      "helpMarkDown": "Inline block with shipyard content",
      "groupName": "config",
      "visibleRule": "shipyardKind = inline"
    },
    {
      "name": "shipyardFile",
      "type": "filePath",
      "label": "Path to shipyard file",
      "required": true,
      "helpMarkDown": "Path to the custom shipyard file. If not provided, a simple default is generated.",
      "groupName": "config",
      "visibleRule": "shipyardKind = file"
    },
    {
      "name": "monitoring",
      "type": "pickList",
      "label": "Type of monitoring to configure",
      "options": {
        "dynatrace": "Dynatrace",
        "prometheus": "Prometheus"
      },
      "required": false,
      "helpMarkDown": "The type of monitoring to configure",
      "groupName": "config"
    },
    {
      "name": "sli",
      "type": "filePath",
      "label": "Path to SLI file",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Path to Service Level Indicator configuration",
      "groupName": "config"
    },
    {
      "name": "slo",
      "type": "filePath",
      "label": "Path to SLO file",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Path to Service Level Objective configuration",
      "groupName": "config"
    },
    {
      "name": "dynatraceConf",
      "type": "filePath",
      "label": "Path to dynatrace.conf file",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Path to dynatrace configuration",
      "groupName": "config",
      "visibleRule": "monitoring = dynatrace"
    }
  ],
  "minimumAgentVersion": "1.83.0",
  "instanceNameFormat": "Prepare Keptn environment",
  "execution": {
    "Node10": {
      "target": "index.js",
      "argumentFormat": ""
    }
  }
}
